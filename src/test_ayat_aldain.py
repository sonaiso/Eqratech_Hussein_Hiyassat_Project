# test_ayat_aldain.py
# تطبيق fractal_balance على آية الدَّيْن (البقرة: 282)

import sys
sys.path.insert(0, '/home/claude')
from fractal_balance import fractal_min_balance as fractal_min_balance_from_second

# آية الدَّيْن - البقرة 282 (مشكولة جزئياً - الكلمات الرئيسية)
ayat_aldain_words = [
    "يَاأَيُّهَا",
    "الَّذِينَ",
    "آمَنُوا",
    "إِذَا",
    "تَدَايَنتُمْ",
    "بِدَيْنٍ",
    "إِلَى",
    "أَجَلٍ",
    "مُسَمًّى",
    "فَاكْتُبُوهُ",
    "وَلْيَكْتُبْ",
    "بَيْنَكُمْ",
    "كَاتِبٌ",
    "بِالْعَدْلِ",
    "وَلَا",
    "يَأْبَ",
    "كَاتِبٌ",
    "أَنْ",
    "يَكْتُبَ",
    "كَمَا",
    "عَلَّمَهُ",
    "اللَّهُ",
    "فَلْيَكْتُبْ",
    "وَلْيُمْلِلِ",
    "الَّذِي",
    "عَلَيْهِ",
    "الْحَقُّ",
    "وَلْيَتَّقِ",
    "اللَّهَ",
    "رَبَّهُ",
    "وَلَا",
    "يَبْخَسْ",
    "مِنْهُ",
    "شَيْئًا",
    "فَإِنْ",
    "كَانَ",
    "الَّذِي",
    "عَلَيْهِ",
    "الْحَقُّ",
    "سَفِيهًا",
    "أَوْ",
    "ضَعِيفًا",
    "أَوْ",
    "لَا",
    "يَسْتَطِيعُ",
    "أَنْ",
    "يُمِلَّ",
    "هُوَ",
    "فَلْيُمْلِلْ",
    "وَلِيُّهُ",
    "بِالْعَدْلِ",
    "وَاسْتَشْهِدُوا",
    "شَهِيدَيْنِ",
    "مِنْ",
    "رِجَالِكُمْ",
    "فَإِنْ",
    "لَمْ",
    "يَكُونَا",
    "رَجُلَيْنِ",
    "فَرَجُلٌ",
    "وَامْرَأَتَانِ",
    "مِمَّنْ",
    "تَرْضَوْنَ",
    "مِنَ",
    "الشُّهَدَاءِ",
    "أَنْ",
    "تَضِلَّ",
    "إِحْدَاهُمَا",
    "فَتُذَكِّرَ",
    "إِحْدَاهُمَا",
    "الْأُخْرَى",
    "وَلَا",
    "يَأْبَ",
    "الشُّهَدَاءُ",
    "إِذَا",
    "مَا",
    "دُعُوا",
    "وَلَا",
    "تَسْأَمُوا",
    "أَنْ",
    "تَكْتُبُوهُ",
    "صَغِيرًا",
    "أَوْ",
    "كَبِيرًا",
    "إِلَى",
    "أَجَلِهِ",
    "ذَلِكُمْ",
    "أَقْسَطُ",
    "عِنْدَ",
    "اللَّهِ",
    "وَأَقْوَمُ",
    "لِلشَّهَادَةِ",
    "وَأَدْنَى",
    "أَلَّا",
    "تَرْتَابُوا",
    "إِلَّا",
    "أَنْ",
    "تَكُونَ",
    "تِجَارَةً",
    "حَاضِرَةً",
    "تُدِيرُونَهَا",
    "بَيْنَكُمْ",
    "فَلَيْسَ",
    "عَلَيْكُمْ",
    "جُنَاحٌ",
    "أَلَّا",
    "تَكْتُبُوهَا",
    "وَأَشْهِدُوا",
    "إِذَا",
    "تَبَايَعْتُمْ",
    "وَلَا",
    "يُضَارَّ",
    "كَاتِبٌ",
    "وَلَا",
    "شَهِيدٌ",
    "وَإِنْ",
    "تَفْعَلُوا",
    "فَإِنَّهُ",
    "فُسُوقٌ",
    "بِكُمْ",
    "وَاتَّقُوا",
    "اللَّهَ",
    "وَيُعَلِّمُكُمُ",
    "اللَّهُ",
    "وَاللَّهُ",
    "بِكُلِّ",
    "شَيْءٍ",
    "عَلِيمٌ",
]

print("=" * 70)
print("تحليل آية الدَّيْن (البقرة: 282) - برهان التوازن الفراكتالي")
print("=" * 70)

weight_candidates = []
under_weight = []

for word in ayat_aldain_words:
    result = fractal_min_balance_from_second(word)
    sylls = result.lower_signature.get("debug", {}).get("syllables", [])
    class_hint = result.upper_projection.get("class_hint", "-")
    
    symbol = "✅" if result.ok else "⚪"
    print(f"{symbol} {word:20} | {class_hint:18} | مقاطع: {sylls}")
    
    if result.ok:
        weight_candidates.append(word)
    else:
        under_weight.append(word)

print("\n" + "=" * 70)
print(f"📊 الإجمالي: {len(ayat_aldain_words)} كلمة")
print(f"✅ حاملات وزن (WEIGHT_CANDIDATE): {len(weight_candidates)}")
print(f"⚪ دون الوزن (UNDER_WEIGHT)     : {len(under_weight)}")
print(f"📈 نسبة حاملات الوزن: {100*len(weight_candidates)/len(ayat_aldain_words):.1f}%")
print("\n⚪ كلمات دون الوزن:")
print("   " + " | ".join(under_weight))
